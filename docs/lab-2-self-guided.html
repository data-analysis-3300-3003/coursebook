<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>coursebook - 4&nbsp; Introduction</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./lab-2-practice-exercises.html" rel="next">
<link href="./lab-2.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Introduction</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">coursebook</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Welcome</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./unit-overview.html" class="sidebar-item-text sidebar-link">Unit overview</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./software.html" class="sidebar-item-text sidebar-link">Software</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./readings.html" class="sidebar-item-text sidebar-link">Reading</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab-1.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 1</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab-1-practice-exercises.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 1 (practice)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab-2.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 2</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab-2-self-guided.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Week 2 (self-guided)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab-2-practice-exercises.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 2 (practice)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab-3.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 3</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab-3-self-guided.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 3 (self-guided)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab-3-practice-exercises.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 3 (practice)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab-4.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 4</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab-4-self-guided.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 4 (self-guided)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab-5.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 5</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab-5-self-guided.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 5 (self-guided)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab-6-self-guided.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 6 (self-guided)</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#geospatial-data-io" id="toc-geospatial-data-io" class="nav-link active" data-scroll-target="#geospatial-data-io">Geospatial data I/O</a>
  <ul class="collapse">
  <li><a href="#task" id="toc-task" class="nav-link" data-scroll-target="#task">Task</a></li>
  </ul></li>
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a>
  <ul class="collapse">
  <li><a href="#run-the-labs" id="toc-run-the-labs" class="nav-link" data-scroll-target="#run-the-labs">Run the labs</a></li>
  <li><a href="#download-data" id="toc-download-data" class="nav-link" data-scroll-target="#download-data">Download data</a></li>
  <li><a href="#working-in-colab" id="toc-working-in-colab" class="nav-link" data-scroll-target="#working-in-colab">Working in Colab</a></li>
  <li><a href="#import-modules" id="toc-import-modules" class="nav-link" data-scroll-target="#import-modules">Import modules</a></li>
  </ul></li>
  <li><a href="#geospatial-data" id="toc-geospatial-data" class="nav-link" data-scroll-target="#geospatial-data">Geospatial data</a></li>
  <li><a href="#geopandas-geodataframe" id="toc-geopandas-geodataframe" class="nav-link" data-scroll-target="#geopandas-geodataframe">GeoPandas GeoDataFrame</a></li>
  <li><a href="#geojson" id="toc-geojson" class="nav-link" data-scroll-target="#geojson">GeoJSON</a></li>
  <li><a href="#geotiff" id="toc-geotiff" class="nav-link" data-scroll-target="#geotiff">GeoTIFF</a>
  <ul class="collapse">
  <li><a href="#numpy-ndarrays" id="toc-numpy-ndarrays" class="nav-link" data-scroll-target="#numpy-ndarrays">NumPy <code>ndarray</code>s</a></li>
  <li><a href="#visualising-raster-data" id="toc-visualising-raster-data" class="nav-link" data-scroll-target="#visualising-raster-data">Visualising raster data</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-title">Introduction</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="geospatial-data-io" class="level2">
<h2 class="anchored" data-anchor-id="geospatial-data-io">Geospatial data I/O</h2>
<p>Data analysis tasks involve reading data stored in files on disks, servers in the cloud, or recorded by sensors. Also, we need to save the results of our analysis or datasets we have generated to files.</p>
<section id="task" class="level3">
<h3 class="anchored" data-anchor-id="task">Task</h3>
<p>In this lab we will write a program that can convert crop yield data collected from a harvester into a geospatial data structure for vector data and write this data to disk using a geospatial file format. You will also write a program that can read geospatial image (raster) data from files into array objects that can be analysed in Python programs.</p>
<p>This lab will introduce:</p>
<ul>
<li>geospatial data file formats</li>
<li>techniques for reading and writing from geospatial data from and to files</li>
<li>Python data structures for representing vector data (<code>GeoDataFrame</code> objects)</li>
<li>Python data structures for representing raster data (NumPy <code>ndarray</code> objects)</li>
</ul>
</section>
</section>
<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<section id="run-the-labs" class="level3">
<h3 class="anchored" data-anchor-id="run-the-labs">Run the labs</h3>
<p>You can run the labs locally on your machine or you can use cloud environments provided by Google Colab. <strong>If you’re working with Google Colab be aware that your sessions are temporary and you’ll need to take care to save, backup, and download your work.</strong></p>
<p><a href="https://colab.research.google.com/github/data-analysis-3300-3003/colab/blob/main/lab-2-self-guided.ipynb" target="_blank"> <img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"> </a></p>
</section>
<section id="download-data" class="level3">
<h3 class="anchored" data-anchor-id="download-data">Download data</h3>
<p>If you need to download the date for this lab, run the following code snippet.</p>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">"week-2"</span> <span class="kw">not</span> <span class="kw">in</span> os.listdir(os.getcwd()):</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    os.system(<span class="st">'wget "https://github.com/data-analysis-3300-3003/data/raw/main/data/week-2.zip"'</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    os.system(<span class="st">'unzip "week-2.zip"'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="working-in-colab" class="level3">
<h3 class="anchored" data-anchor-id="working-in-colab">Working in Colab</h3>
<p>If you’re working in Google Colab, you’ll need to install the required packages that don’t come with the colab environment.</p>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">'google.colab'</span> <span class="kw">in</span> <span class="bu">str</span>(get_ipython()):</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="op">!</span>pip install geopandas</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">!</span>pip install pyarrow</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">!</span>pip install mapclassify</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">!</span>pip install rasterio</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="import-modules" class="level3">
<h3 class="anchored" data-anchor-id="import-modules">Import modules</h3>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> rasterio</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> folium</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.io <span class="im">as</span> pio</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pprint</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># setup renderer</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">'google.colab'</span> <span class="kw">in</span> <span class="bu">str</span>(get_ipython()):</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    pio.renderers.default <span class="op">=</span> <span class="st">"colab"</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    pio.renderers.default <span class="op">=</span> <span class="st">"jupyterlab"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="geospatial-data" class="level2">
<h2 class="anchored" data-anchor-id="geospatial-data">Geospatial data</h2>
<p>Geospatial data is used to take geographic features or phenomenon and represent them as data in computer program or file.</p>
<p>There are two main types of geospatial data:</p>
<ul>
<li><strong>vector data</strong> - point, line, or polygon geometries</li>
<li><strong>raster data</strong> - images and arrays</li>
</ul>
<p>There are two components to geospatial data:</p>
<ul>
<li><strong>Positional information</strong> describing location, shape, and extent (e.g.&nbsp;an <code>(x, y)</code> coordinate pair representing the location of a weather station).</li>
<li><strong>Attribute information</strong> describing characteristics of the phenomenon or entity (e.g.&nbsp;a name:value pair recording the name of the weather station <code>name:'Perth Airport'</code>).</li>
</ul>
<section id="raster-data-model" class="level4">
<h4 class="anchored" data-anchor-id="raster-data-model">Raster data model</h4>
<p>Raster data breaks the Earth’s surface up into a grid of cells (pixels). Each pixel is assigned a value that corresponds to the geographic feature or phenomenon of interest. For example, pixels in a raster precipitation dataset would be assigned a numeric value that represents the amount of precipitation that fell at that location. Pixels in a land cover map would have an integer value that corresponds to a particular land cover class label. The values assigned to pixels in a raster dataset are the attribute information.</p>
<p><img src="https://github.com/data-analysis-3300-3003/figs/raw/main/week-2-raster-data-lc.png" class="img-fluid"></p>
<p>The size of the pixels relative to their position on the Earth’s surface determines the spatial detail that can be resolved in the raster dataset. A land cover map with pixels that represent a 1 km x 1 km portion of the Earth’s surface will not be able to identify features such as individual buildings.</p>
<!-- The figure below shows the 2018 European Space Agency (ESA) Climate Change Initiative (CCI) land cover map. Each pixel represents a 300 m x 300 m area on the Earth’s land surface and a pixel can only represent a single land cover type. If you look at the bottom two zoomed in maps you can see some limitations of representing land cover using 300 m x 300 m spatial resolution raster data. The shape of land cover features are poorly represented by the “block-like” arrangement of pixels and there is variation in land cover within a single pixel (a mixed pixel problem).

![](https://github.com/data-analysis-3300-3003/figs/raw/main/week-2-raster-data-model.png) -->
</section>
<section id="vector-data-model" class="level4">
<h4 class="anchored" data-anchor-id="vector-data-model">Vector data model</h4>
<p>Vector data uses point, line, or polygon geometries to represent geographic features.</p>
<p><strong>Coordinate pairs:</strong> point locations or the vertices in lines and polygons are represented using coordinate pairs. The coordinate pairs indicate where that feature is located on the Earth’s surface (relative to an origin); longitude and latitute are commonly used as coordinate pairs.</p>
<p><strong>Attribute information:</strong> vector data also stores non-spatial attribute information which describe characteristics of the geographic phenomenon or entity represented by the geometry feature.</p>
<p><img src="https://github.com/data-analysis-3300-3003/figs/raw/main/week-2-vector-data.jpg" class="img-fluid"></p>
</section>
</section>
<section id="geopandas-geodataframe" class="level2">
<h2 class="anchored" data-anchor-id="geopandas-geodataframe">GeoPandas GeoDataFrame</h2>
<p>A GeoPandas <code>GeoDataFrame</code> is a tabular data structure for storing vector geospatial data and is based on a regular pandas <code>DataFrame</code>.</p>
<p>A <code>GeoDataFrame</code> consists of columns of non-spatial attributes similar to a pandas <code>DataFrame</code>. However, a <code>GeoDataFrame</code> also has a <code>geometry</code> column which is a <code>GeoSeries</code> of geometries for the spatial data associated with each row.</p>
<p>In Python, geometries are represented as <a href="https://shapely.readthedocs.io/en/stable/geometry.html" target="_blank">Shapely</a> <code>Geometry</code> objects. The <code>geometry</code> column in a GeoPandas <code>GeoDataFrame</code> is a <code>Series</code> of Shapely <code>Geometry</code> objects. Printing a <a href="https://shapely.readthedocs.io/en/stable/geometry.html" target="_blank">Shapely</a> <code>Geometry</code> object returns a Well Known Text (WKT) string description of the geometry (e.g.&nbsp;<code>POINT (0, 1)</code>). The <code>geometry</code> column of a <code>GeoDataFrame</code> (or a <code>GeoSeries</code>) can be viewed as a sequence of Shapely <code>Geometry</code> objects:</p>
<pre><code>a_geoseries = [POINT (0, 1), POINT (0, 2), POINT (2, 3)]</code></pre>
<p>Shapely provides tools for representing geometries in Python programs. It does not provide tools for reading geometry data from disk or handling attribute data. GeoPandas <code>GeoDataFrame</code> and <code>GeoSeries</code> combine Shapely’s functionality for handling geometries with tools for reading and writing vector data, handling attributes, and visualisation. Therefore, we will focus on using <code>GeoDataFrame</code>s in these labs.</p>
<p>Let’s convert a CSV file with longitude, latitude, and elevation columns into a <code>GeoDataFrame</code>. First, let’s read the CSV file in as a pandas <code>DataFrame</code>.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>elev_df <span class="op">=</span> pd.read_csv(os.path.join(os.getcwd(), <span class="st">"week-2"</span>, <span class="st">"week-2-bf66-elevation.csv"</span>))</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>elev_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Northing</th>
      <th>Easting</th>
      <th>Lat</th>
      <th>Lon</th>
      <th>Elevation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6503882.129</td>
      <td>545428.0052</td>
      <td>-31.599262</td>
      <td>117.478873</td>
      <td>268.920</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6503806.024</td>
      <td>545427.6719</td>
      <td>-31.599948</td>
      <td>117.478873</td>
      <td>265.908</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6503881.794</td>
      <td>545504.4826</td>
      <td>-31.599262</td>
      <td>117.479680</td>
      <td>268.171</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6503805.688</td>
      <td>545504.1488</td>
      <td>-31.599948</td>
      <td>117.479680</td>
      <td>265.413</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6503729.582</td>
      <td>545503.8149</td>
      <td>-31.600635</td>
      <td>117.479680</td>
      <td>263.080</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Now, let’s use the longtitude and latitude columns in the <code>DataFrame</code> to convert the elevation data into a GeoPandas <code>GeoDataFrame</code>.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the elevation data to a spatial format</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>points <span class="op">=</span> gpd.points_from_xy(elev_df[<span class="st">"Lon"</span>], elev_df[<span class="st">"Lat"</span>], crs<span class="op">=</span><span class="st">"EPSG:4326"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"points is of type </span><span class="sc">{</span><span class="bu">type</span>(points)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>elev_gdf <span class="op">=</span> gpd.GeoDataFrame(elev_df, geometry<span class="op">=</span>points)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"elev_gdf is of type </span><span class="sc">{</span><span class="bu">type</span>(elev_gdf)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>elev_gdf.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>points is of type &lt;class 'geopandas.array.GeometryArray'&gt;
elev_gdf is of type &lt;class 'geopandas.geodataframe.GeoDataFrame'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="5">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Northing</th>
      <th>Easting</th>
      <th>Lat</th>
      <th>Lon</th>
      <th>Elevation</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6503882.129</td>
      <td>545428.0052</td>
      <td>-31.599262</td>
      <td>117.478873</td>
      <td>268.920</td>
      <td>POINT (117.47887 -31.59926)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6503806.024</td>
      <td>545427.6719</td>
      <td>-31.599948</td>
      <td>117.478873</td>
      <td>265.908</td>
      <td>POINT (117.47887 -31.59995)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6503881.794</td>
      <td>545504.4826</td>
      <td>-31.599262</td>
      <td>117.479680</td>
      <td>268.171</td>
      <td>POINT (117.47968 -31.59926)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6503805.688</td>
      <td>545504.1488</td>
      <td>-31.599948</td>
      <td>117.479680</td>
      <td>265.413</td>
      <td>POINT (117.47968 -31.59995)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6503729.582</td>
      <td>545503.8149</td>
      <td>-31.600635</td>
      <td>117.479680</td>
      <td>263.080</td>
      <td>POINT (117.47968 -31.60064)</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<section id="recap-quiz" class="level4">
<h4 class="anchored" data-anchor-id="recap-quiz">Recap quiz</h4>
<p>You will need to refer to the GeoPandas documentation to answer these questions.</p>
<details>
<summary>
<b>What does executing the <code>GeoDataFrame</code> method <a href="https://geopandas.org/en/stable/docs/reference/api/geopandas.points_from_xy.html" target="_blank"><code>points_from_xy()</code></a> return?</b>
</summary>
<code>points_from_xy()</code> expects a pandas <code>Series</code> objects for x and y coordinates and coordinate reference system. It will return to a GeoPandas <code>GeometryArray</code> object which stores a POINT geometry object for each x and y pair and can be converted into a <code>GeoSeries</code> object.
</details>
<p>
</p>
<details>
<summary>
<b>The <a href="https://geopandas.org/en/stable/docs/reference/api/geopandas.GeoDataFrame.html#geopandas.GeoDataFrame" target="_blank"><code>GeoDataFrame()</code></a> constructor function can take three arguments. What are these arguments and how do they enable the creation of a <code>GeoDataFrame</code> object?</b>
</summary>
The <code>GeoDataFrame()</code> constructor function requires a pandas <code>DataFrame</code> as its first argument. This data is the non-spatial attributes. The second (optional) argument is a GeoPandas object which stores <code>geometry</code> objects associated with each row (this could also be a string denoting the column of a <code>DataFrame</code> storing geometries. The third (optional) argument is a crs denoting the coordinate reference system for the geometry data.
</details>
</section>
</section>
<section id="geojson" class="level2">
<h2 class="anchored" data-anchor-id="geojson">GeoJSON</h2>
<p>So far we have been reading and writing non-spatial tabular data. Parquet and CSV files are well suited for storing tabular data.</p>
<p>However, there are different ways of structuring data, some datasets don’t lend themselves to tabular structures, and there are different uses of data files than storage on disk.</p>
<p>JSON data (JavaScript Object Notation for its full name) is a widely used format for data interchange (exchanging data between programs, computers, clients, and servers).</p>
<p>JSON represents data as key:value pairs enclosed within curly brackets <code>{}</code> (you might notice the similarity with Python’s dictionary data structure).</p>
<p>This is an example of JSON data:</p>
<pre><code>{
    "title": "Introducing JSON",
    "url": "https://www.json.org/json-en.html"
}</code></pre>
<p>The values in JSON data can include text (strings), numbers, arrays (lists), and nested JSON objects. Like the CSV format, JSON is a text based format where human readable characters are encoded in binary using UTF-8 or UTF-16.</p>
<p>GeoJSON is an extension of the JSON format for storing and exchanging spatial data. One of GeoJSON’s uses is sending spatial data to web browsers to render as layers on web maps.</p>
<p>GeoJSON represents geographic features as vector data (points, lines, and polygon geometries) and can also store non-spatial attribute information.</p>
<p>Spatial data in GeoJSON are represented using <code>geometry</code> types which include:</p>
<p><code>Point</code></p>
<pre><code>{"type": "Point", "coordinates": [1, 1]}</code></pre>
<p><code>LineString</code></p>
<pre><code>{"type": "LineString", "coordinates": [[1, 1], [2, 2]]}</code></pre>
<p><code>Polygon</code></p>
<pre><code>{"type": "Polygon", "coordinates": [[[1, 1], [2, 2], [1, 2], [1, 1]]]}</code></pre>
<p><code>Feature</code> types include attribute data as <code>properties</code> with <code>geometry</code> types.</p>
<pre><code>{
    "type": "Feature",
    "geometry": {
        "type": "Point",
        "coordinates": [0, 0]
    }, 
    "properties": {
        "name": "Perth Airport"
    }
}</code></pre>
<p>A <code>FeatureCollection</code> is a collection of <code>Feature</code>s.</p>
<pre><code>{
    "type": "FeatureCollection",
    "features": [
        {
            "type": "Feature",
            "geometry": {
                "type": "Point",
                "coordinates": [0, 0]
            }, 
            "properties": {
                "name": "Perth Airport"
            }
        },
        {
            "type": "Feature",
            "geometry": {
                "type": "Point",
                "coordinates": [10, 1]
            }, 
            "properties": {
                "name": "Broome Airport"
            }
        }
        
    ]
}</code></pre>
<p>You can read <a href="https://macwright.com/2015/03/23/geojson-second-bite.html#featurecollection" target="_blank">More than you ever wanted to know about GeoJSON</a> for a description of the GeoJSON format.</p>
<p>Let’s get the first two rows of the <code>GeoDataFrame</code> and convert them to GeoJSON format. <code>GeoDataFrame</code>s have a <code>to_json()</code> method which can be used to convert the data in the <code>GeoDataFrame</code> into a string object in GeoJSON format.</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the first two rows of the elevation GeoDataFrame and convert to GeoJSON</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>elev_gdf_2 <span class="op">=</span> elev_gdf.iloc[<span class="dv">0</span>:<span class="dv">2</span>, :]</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>elev_gdf_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Northing</th>
      <th>Easting</th>
      <th>Lat</th>
      <th>Lon</th>
      <th>Elevation</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6503882.129</td>
      <td>545428.0052</td>
      <td>-31.599262</td>
      <td>117.478873</td>
      <td>268.920</td>
      <td>POINT (117.47887 -31.59926)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6503806.024</td>
      <td>545427.6719</td>
      <td>-31.599948</td>
      <td>117.478873</td>
      <td>265.908</td>
      <td>POINT (117.47887 -31.59995)</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>elev_geojson_2 <span class="op">=</span> elev_gdf_2.to_json()</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The GeoJSON data is stored as a </span><span class="sc">{</span><span class="bu">type</span>(elev_geojson_2)<span class="sc">}</span><span class="ss"> type object"</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">""</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>pprint.pprint(elev_geojson_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The GeoJSON data is stored as a &lt;class 'str'&gt; type object

('{"type": "FeatureCollection", "features": [{"id": "0", "type": "Feature", '
 '"properties": {"Northing": 6503882.129, "Easting": 545428.0052, "Lat": '
 '-31.59926178, "Lon": 117.4788733, "Elevation": 268.92}, "geometry": {"type": '
 '"Point", "coordinates": [117.4788733, -31.59926178]}}, {"id": "1", "type": '
 '"Feature", "properties": {"Northing": 6503806.024, "Easting": 545427.6719, '
 '"Lat": -31.59994843, "Lon": 117.4788733, "Elevation": 265.908}, "geometry": '
 '{"type": "Point", "coordinates": [117.4788733, -31.59994843]}}]}')</code></pre>
</div>
</div>
<p>In Python, the GeoJSON data that we have generated from our <code>GeoDataFrame</code> is stored as a string object. GeoJSON (and JSON) is a text-based data similar to CSV files. However, unlike the CSV format where data has a tabular structure with records arranged by row the GeoJSON data is based around nested objects of key:value pairs.</p>
<p>As we have subsetted the first two rows of our <code>GeoDataFrame</code> and converted them to GeoJSON we have generated a <code>FeatureCollection</code> object with two <code>Feature</code>s.</p>
<p>Each row in the <code>GeoDataFrame</code> is converted to a <code>Feature</code> and each <code>Feature</code> has the column values per row stored in a <code>properties</code> object - these are the non-spatial attributes associated with each <code>Point</code> feature. The spatial information is stored in a <code>geometry</code> object which contains two key:value pairs. The value associated with the <code>type</code> key tells us this is a <code>Point</code> geometry and the array value associated with <code>coordinates</code> key defines the location.</p>
<p>Compare the tabular display of the <code>GeoDataFrame</code> to the print of the GeoJSON to see how the non-spatial and spatial information in the table structure is converted to the GeoJSON nested format.</p>
<p>We can save a <code>GeoDataFrame</code> to GeoJSON using the <code>GeoDataFrame</code>’s <code>to_file()</code> method and setting the driver argument to GeoJSON.</p>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the elevation GeoDataFrame to a GeoJSON file</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>elev_gdf.to_file(os.path.join(os.getcwd(), <span class="st">"week-2"</span>, <span class="st">"week-2-bf66-elevation.geojson"</span>), driver<span class="op">=</span><span class="st">"GeoJSON"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Check the GeoJSON file has saved to the directory specified. As it is text data, if you click on it you should be able to inspect its format in a text editor.</p>
<section id="recap-quiz-1" class="level4">
<h4 class="anchored" data-anchor-id="recap-quiz-1">Recap quiz</h4>
<details>
<summary>
<b>Identify two differences between the GeoJSON file format and a GeoPandas <code>GeoDataFrame</code></b>
</summary>
<ul>
<li>
A <code>GeoDataFrame</code> is used to store geospatial data in memory for Python programs. A GeoJSON file format describes how geospatial data should be encoded when it is stored on disk.
</li>
<li>
A <code>GeoDataFrame</code> uses a tabular structure to organise non-spatial and spatial attributes with each row corresponding to a feature. GeoJSON format uses dictionary-like structure of key:value pairs with geographic data (coordinates) stored as values with a <code>geometry</code> key and attribute data stored as values with a <code>properties</code> key.
</li>
</ul>
</details>
<p><strong>You saved the elevation data to a GeoJSON file at this path: <code>os.path.join(os.getcwd(), "week-2", "week-2-bf66-elevation.geojson")</code>.</strong></p>
<p><strong>Head to the <a href="https://geopandas.org/en/stable/getting_started/introduction.html#Reading-and-writing-files" target="_blank">GeoPandas documentation</a> and look up how to read files into <code>GeoDataFrame</code> objects. Read the <em>elevation.geojson</em> file into a <code>GeoDataFrame</code> referenced by the variable <code>elev_from_file</code>.</strong></p>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">## ADD CODE HERE ##</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details>
<summary>
<b>answer</b>
</summary>
<div class="sourceCode" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>elev_from_file <span class="op">=</span> gpd.read_file(os.path.join(os.getcwd(), <span class="st">"week-2"</span>, <span class="st">"week-2-bf66-elevation.geojson"</span>))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>elev_from_file.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
Note, this answer assumes GeoPandas has been imported as gpd.
</details>
<p><strong>Write the data referenced by <code>elev_from_file</code> to disk as a GeoPackage.</strong></p>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">## ADD CODE HERE ##</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details>
<summary>
<b>answer</b>
</summary>
<div class="sourceCode" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>elev_from_file.to_file(os.path.join(os.getcwd(), <span class="st">"week-2"</span>, <span class="st">"week-2-bf66-elevation.gpkg"</span>), driver<span class="op">=</span><span class="st">"GPKG"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</section>
</section>
<section id="geotiff" class="level2">
<h2 class="anchored" data-anchor-id="geotiff">GeoTIFF</h2>
<p>We have demonstrated how we can read and write tabular data and vector geospatial data from and to files. However, many geospatial datasets are based on the raster data model where values are assigned to pixels and pixels represent locations on the Earth’s surface.</p>
<p>A common source of raster data are remote sensing images captured by sensors on uncrewed aerial vehicles, aircraft, or satellites. Optical remote sensing images store the measured reflectance of light off the Earth’s land surface in different wavelenghts. Raster remote sensing images are often stored using the <a href="https://gdal.org/drivers/raster/gtiff.html" target="_blank">GeoTIFF</a> format.</p>
<p>A GeoTIFF file is based on the Tagged Image File Format (or .tiff file) which is a general format for storing image data. A TIFF file comprises:</p>
<ul>
<li>a <strong>TIFF header</strong> which includes 8 bytes that tell us that the file is in TIFF format and where in the file (what byte number / byte offset from 0) the first Image File Directory is stored.</li>
<li><strong>Image File Directories</strong> which contains image metadata, a pointer to where the image data is in the file (what byte number / byte offset from 0), and the location of the next Image File Directory if there is more than one image stored in the TIFF file. Metadata is stored as fields which comprise a TIFF tag and it’s corresponding value.</li>
<li><strong>Image Data</strong> - the values associated with each pixel in the image. A single TIFF file can store multiple images.</li>
</ul>
<p><img src="https://github.com/data-analysis-3300-3003/figs/raw/main/week-2-geotiff.jpg" class="img-fluid"></p>
<p>GeoTIFF files include extra information (metadata) as tags which describe the coordinate reference system (CRS) of the image data (i.e.&nbsp;where on the Earth’s surface the image data corresponds to), spatial resolution, no data values, and various other configurations described <a href="https://gdal.org/drivers/raster/gtiff.html" target="_blank">here</a>.</p>
<p>GeoTIFF files can store multiple images (i.e.&nbsp;raster layers) in a single file. This makes them well suited for storing remote sensing image data where each raster layer corresponds to measured reflectance in a particular wavelength.</p>
<p>We can use the functions provided by the <a href="https://rasterio.readthedocs.io/en/latest/" target="_blank">rasterio</a> package to read and write raster data in Python.</p>
<p>We can use rasterio to create a file connection to raster data stored in a GeoTIFF file and use this file connection object to read the raster data into a Python data structure. Rasterio reads raster data from GeoTIFF files on disk into NumPy <code>ndarray</code>s in memory.</p>
<p>The GeoTIFF file <em>week-2-s2-summer-2020.tif</em> stores remote sensing data covering the same field that the elevation and canola yield data were collected from. The remote sensing data was captured by the <a href="https://sentinel.esa.int/web/sentinel/missions/sentinel-2" target="_blank">European Space Agency’s Sentinel-2 satellite</a> (10 m spatial resolution).</p>
<p>We use the <code>with</code> statement and context managers to <code>open()</code> connections to GeoTIFF files to <code>read()</code> raster data from them using rasterio. As we’re using a context manager to handle connections to the file we don’t need to call <code>close()</code> on the <code>file</code> connection object.</p>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># path the the GeoTIFF file</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>s2_path <span class="op">=</span> os.path.join(os.getcwd(), <span class="st">"week-2"</span>, <span class="st">"week-2-s2-summer-2020.tif"</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># open the GeoTIFF file and read its metadata and image data</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> rasterio.<span class="bu">open</span>(s2_path) <span class="im">as</span> src:</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    meta <span class="op">=</span> src.meta</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    rgb <span class="op">=</span> src.read([<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>])</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    red_band <span class="op">=</span> src.read(<span class="dv">4</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    green_band <span class="op">=</span> src.read(<span class="dv">3</span>)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    blue_band <span class="op">=</span> src.read(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The <code>file</code> object <code>src</code> is the connection to the GeoTIFF file and it has a <code>meta</code> property. The <code>meta</code> property stores metadata that describes the raster data in the GeoTIFF file. Let’s explore this metadata.</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>pprint.pprint(meta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{'count': 23,
 'crs': CRS.from_epsg(4326),
 'driver': 'GTiff',
 'dtype': 'float32',
 'height': 232,
 'nodata': None,
 'transform': Affine(8.983152841195215e-05, 0.0, 117.47574397627584,
       0.0, -8.983152841195215e-05, -31.58916713453456),
 'width': 321}</code></pre>
</div>
</div>
<p>From the <code>meta</code> object we can see the data type of the raster:</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(meta[<span class="st">"dtype"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>float32</code></pre>
</div>
</div>
<p>We can also see the dimensions of each raster band:</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"width: </span><span class="sc">{</span>meta[<span class="st">'width'</span>]<span class="sc">}</span><span class="ss">"</span>) </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"height: </span><span class="sc">{</span>meta[<span class="st">'height'</span>]<span class="sc">}</span><span class="ss">"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>width: 321
height: 232</code></pre>
</div>
</div>
<p>The <code>count</code> property of the <code>meta</code> object is the number of bands or raster layers in the GeoTIFF file:</p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"number of bands: </span><span class="sc">{</span>meta[<span class="st">'count'</span>]<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>number of bands: 23</code></pre>
</div>
</div>
<p>And, we can see the coordinate reference system of the raster data:</p>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(meta[<span class="st">"crs"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>EPSG:4326</code></pre>
</div>
</div>
<section id="numpy-ndarrays" class="level3">
<h3 class="anchored" data-anchor-id="numpy-ndarrays">NumPy <code>ndarray</code>s</h3>
<p>Calling the <code>read()</code> method of the <code>file</code> connection object to the GeoTIFF file reads the raster data into a NumPy <code>ndarray</code> object. We can specify a number as an argument to the <code>read()</code> method to indicate which raster bands we want to read from the GeoTIFF file. For example, <code>read(2)</code> will read the second band. If we specify a list of numbers we will read several bands into a multidimensional <code>ndarray</code> object.</p>
<p>NumPy is a library used for scientific and numerical computing and is based around an N-dimensional <code>ndarray</code> object. An <code>ndarray</code> is a grid of elements of the same data type. The dimensions of a NumPy <code>ndarray</code> are called axes. NumPy <code>array</code>s can be created from sequences of values (e.g.&nbsp;stored in lists, tuples, other <code>ndarray</code>s).</p>
<p>We can create a simple 1-dimensional <code>ndarray</code> using the <code>array()</code> function.</p>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a 1D ndarray</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>arr1d <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>arr1d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>array([1, 2, 3])</code></pre>
</div>
</div>
<p>The rank (or number of dimensions) of a <code>ndarray</code> is the number of axes.</p>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the rank (ndim) of an ndarry is the number of axes </span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"the rank of the ndarray is </span><span class="sc">{</span>arr1d<span class="sc">.</span>ndim<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>the rank of the ndarray is 1</code></pre>
</div>
</div>
<p>The <code>shape</code> of an <code>ndarray</code> tells us the size of each axis (how many elements are arranged along that axis).</p>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the shape of the ndarray </span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"the shape of the ndarray is </span><span class="sc">{</span>arr1d<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>the shape of the ndarray is (3,)</code></pre>
</div>
</div>
<p>A <code>ndarray</code> with 2-dimensions is a matrix with rows arranged on the 0 axis and columns arranged on the 1 axis.</p>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a 2D ndarray</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>arr2d <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]])</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>arr2d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>array([[1, 2, 3],
       [4, 5, 6]])</code></pre>
</div>
</div>
<p>The <code>ndarray</code> pointed to by <code>arr2d</code> is a 2 x 3 matrix of numeric values. We can check this.</p>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"the rank of the ndarray is </span><span class="sc">{</span>arr2d<span class="sc">.</span>ndim<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"the shape of the ndarray is </span><span class="sc">{</span>arr2d<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>the rank of the ndarray is 2
the shape of the ndarray is (2, 3)</code></pre>
</div>
</div>
<p><code>ndarray</code>s can be multidimensional. They can have more than two dimensions. Remote sensing images typically comprise multiple 2-dimensional arrays with each array corresponding to a raster of reflectance measured in a particular wavelength. This 3-dimensional raster data structure can be represented as a NumPy <code>ndarray</code> with the bands dimension on axis 0 (each band is a raster for a given wavelength), rows (height of each raster) on axis 1, and columns (width of each raster) on axis 2.</p>
<p>Let’s create a <code>ndarray</code> with 3-dimensions.</p>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a 3D ndarray</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>arr3d <span class="op">=</span> np.array([[[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]], [[<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>], [<span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>]]])</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>arr3d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>array([[[ 1,  2,  3],
        [ 4,  5,  6]],

       [[ 7,  8,  9],
        [10, 11, 12]]])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"the rank of the ndarray is </span><span class="sc">{</span>arr3d<span class="sc">.</span>ndim<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"the shape of the ndarray is </span><span class="sc">{</span>arr3d<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>the rank of the ndarray is 3
the shape of the ndarray is (2, 2, 3)</code></pre>
</div>
</div>
<p>The concept of N-dimensional arrays can be extended further. For example, a 4-dimensional <code>ndarray</code> could store a sequence of 3-dimensional <code>ndarray</code>s where the fourth dimension is time and the object represents remote sensing images captured across multiple dates.</p>
<section id="recap-quiz-2" class="level4">
<h4 class="anchored" data-anchor-id="recap-quiz-2">Recap quiz</h4>
<p>Execute the following code to read in a normalised difference vegetation index (NDVI) layer computed for the same field from a GeoTIFF file and use this data to answer the following questions.</p>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># path to the ndvi file</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>s2_ndvi_path <span class="op">=</span> os.path.join(os.getcwd(), <span class="st">"week-2"</span>, <span class="st">"week-2-ndvi-summer-2020.tif"</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co"># open the GeoTIFF file and read its metadata and image data</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> rasterio.<span class="bu">open</span>(s2_ndvi_path) <span class="im">as</span> src:</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    meta <span class="op">=</span> src.meta</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    ndvi <span class="op">=</span> src.read(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details>
<summary>
<b>What is the name of the variable that points to the metadata for the NDVI data read from the GeoTIFF file?</b>
</summary>
<code>meta</code>
</details>
<p><strong>Find out what type of object the data referenced by <code>meta</code> is?</strong></p>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">## add code here ##</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details>
<summary>
<b>answer</b>
</summary>
<div class="sourceCode" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(meta))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<p><strong>Find out what type of object the data referenced by <code>ndvi</code> is?</strong></p>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">## add code here ##</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details>
<summary>
<b>answer</b>
</summary>
<div class="sourceCode" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(ndvi))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<p><strong>Use the <code>meta</code> object to identify how many bands the raster data stored in the GeoTIFF <em>week-2-ndvi-summer-2020.tif</em> has?</strong></p>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">## add code here ##</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details>
<summary>
<b>answer</b>
</summary>
<div class="sourceCode" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"There are </span><span class="sc">{</span>meta[<span class="st">'count'</span>]<span class="sc">}</span><span class="ss"> bands in the GeoTIFF file"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<p><strong>Find out how many raster bands have been read into the <code>ndarray</code> object referenced by <code>ndvi</code>?</strong></p>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">## add code here ##</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details>
<summary>
<b>answer</b>
</summary>
<p>
One band has been read into the <code>ndarray</code> object pointed to by <code>ndvi</code>. This is a rank 2 <code>ndarray</code> with row and columns axes and no bands axis.
</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"the rank of the ndvi ndarray is </span><span class="sc">{</span>ndvi<span class="sc">.</span>ndim<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"the shape of the ndvi ndarray is </span><span class="sc">{</span>ndvi<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<details>
<summary>
<b>Do <code>meta[“count”]</code> and the length of the bands axis of the <code>ndarray</code> object generated by a call to <code>read()</code> have to return the same value?</b>
</summary>
Not always. In this case they should return the same value as we are reading the one and only band stored in <em>week-2-ndvi-summer-2020.tif</em> in an <code>ndarray</code> object. However, the value at <code>meta[“count”]</code> will tell us the number of bands in the file while the number of bands stored in the <code>ndarray</code> resulting from a call to <code>read()</code> is determined by the number passed into <code>read()</code>.
</details>
</section>
</section>
<section id="visualising-raster-data" class="level3">
<h3 class="anchored" data-anchor-id="visualising-raster-data">Visualising raster data</h3>
<p>We can use the <code>imshow()</code> function from the Plotly Express package to render data in NumPy <code>ndarray</code>s as an image. The <code>imshow()</code> function expects a NumPy <code>ndarray</code> of raster values to display and a colour map (<code>color_continuous_scale</code>) that relates raster pixel values to a colour on the computer screen.</p>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the red band</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>px.imshow(red_band, color_continuous_scale<span class="op">=</span><span class="st">"Reds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="lab-2-self-guided_files/figure-html/cell-30-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the green band</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>px.imshow(green_band, color_continuous_scale<span class="op">=</span><span class="st">"Greens"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="lab-2-self-guided_files/figure-html/cell-31-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the Blue band</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>px.imshow(blue_band, color_continuous_scale<span class="op">=</span><span class="st">"Blues"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="lab-2-self-guided_files/figure-html/cell-32-output-1.png" class="img-fluid"></p>
</div>
</div>
<section id="recap-quiz-3" class="level4">
<h4 class="anchored" data-anchor-id="recap-quiz-3">Recap quiz</h4>
<p><strong>Earlier we read NDVI data for this field into a <code>ndarray</code> object referenced by <code>ndvi</code>. Visualise this data using the <code>imshow()</code> function and select a suitable colour scale from the Plotly Expess built-in <a href="https://plotly.com/python/builtin-colorscales/" target="_blank">options</a>. NDVI values range from -1 to 1 with higher values associated with greener vegetation.</strong></p>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">## add code here ##</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details>
<summary>
<b>answer</b>
</summary>
<div class="sourceCode" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>px.imshow(ndvi, color_continuous_scale<span class="op">=</span><span class="st">"viridis"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</section>
<section id="colour" class="level4">
<h4 class="anchored" data-anchor-id="colour">Colour</h4>
<p>A particular colour is defined by the intensity of light in different parts of the visible spectrum (e.g.&nbsp;yellow is a mixture of light in red and green wavelengths).</p>
<p>Colour is represented by combinations (addition) of red, green, and blue light. Red, green, and blue are primary colours and combine to form white. An absence of red, green, and blue is black. Secondary colours can be formed by the addition of primary colours of varying intensities (e.g.&nbsp;yellow is the addition of red and green, magenta is the addition of red and blue, and cyan is the addition of green and blue).</p>
<p>Computer displays consist of red, green, and blue sub-pixels, which when activated with different intensities, are perceived as different colours. The range of colours that can be displayed on a computer display is called the gamut. Colour in computer programs is represented as a three byte hexadecimal number with byte 1 corresponding to red, byte 2 corresponding to green, and byte 3 corresponding to blue. Each byte can take the range of 0 to 255 in decimal. 0 indicates the absence of a colour and 255 indicates saturation of that colour:</p>
<ul>
<li>white: 255 255 255</li>
<li>black: 0 0 0</li>
<li>red: 255 0 0</li>
<li>green: 0 255 00</li>
<li>blue: 0 0 255</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://github.com/data-analysis-3300-3003/figs/raw/main/week-2-colour-models-crcsi.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Additive and subtractive colour models (source: CRCSI (2017))</figcaption><p></p>
</figure>
</div>
<p>Computer displays represent colour through varying the intensity of sub-pixel displays of red, green, and blue light. Variability in data values in multiband rasters can be visualised by relating data values in one band to the intensity of one of the primary colours on the computer display. Visualising a multiband raster in this way creates an additive RGB or colour composite image - it is called a composite image because each pixel is a composite of red, green, and blue light.</p>
<p>Above we rendered the red, green, and blue band reflectance from the Sentinel-2 image separately. However, if we combine these reflectance measures into a composite image (e.g.&nbsp;where red reflectance is represented by sub-pixel intensity of red light) we can create a true colour image as if we were looking down on the Earth’s surface with our eyes.</p>
<p>The <code>imshow()</code> function can take a multiband NumPy <code>ndarray</code> and returns an RGB image.</p>
<p>Above, we <code>read()</code> bands 4, 3, and 2 from the GeoTIFF file into NumPy <code>ndarray</code> referenced by <code>rgb</code>. Band 4 corresponds to red reflectance in Sentinel-2 images, band 3 corresponds to green reflectance, and band 2 corresponds to blue reflectance. We can pass <code>rgb</code> into the <code>imshow()</code> function to generate an RGB image of the field.</p>
<p>We can check that <code>rgb</code> has three bands by printing its <code>shape</code> property.</p>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The shape of rgb is </span><span class="sc">{</span>rgb<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The shape of rgb is (3, 232, 321)</code></pre>
</div>
</div>
<p>If we check the <code>imshow()</code> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html" target="_blank">docs</a> we can see that it expects a NumPy <code>ndarray</code> where the bands (or channels as they are sometimes called with images) is the final axis. NumPy has a <code>moveaxis()</code> function where can move the bands dimension to the last axis position before plotting.</p>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the RGB image</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>px.imshow(np.moveaxis(rgb, <span class="dv">0</span>, <span class="dv">2</span>), contrast_rescaling<span class="op">=</span><span class="st">"minmax"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="lab-2-self-guided_files/figure-html/cell-35-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="recap-quiz-4" class="level4">
<h4 class="anchored" data-anchor-id="recap-quiz-4">Recap quiz</h4>
<p><strong>At the file path noted below is a GeoTIFF file storing a normalised difference water index (NDWI) layer. Write a short program to read this raster data, identify the dimensions of the raster data, and visualise the data</strong></p>
<p>File path to NDWI data: <code>os.path.join(os.getcwd(), "week-2", "week-2-ndwi-summer-2020.tif")</code></p>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">## add code here ##</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details>
<summary>
<b>answer</b>
</summary>
<div class="sourceCode" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>s2_ndwi_path <span class="op">=</span> os.path.join(os.getcwd(), <span class="st">"week-2"</span>, <span class="st">"week-2-ndwi-summer-2020.tif"</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> rasterio.<span class="bu">open</span>(s2_ndwi_path) <span class="im">as</span> src:</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>    meta <span class="op">=</span> src.meta</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>    ndwi <span class="op">=</span> src.read(<span class="dv">1</span>)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"the width of the raster layer is </span><span class="sc">{</span>meta[<span class="st">'width'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"the height of the raster layer is </span><span class="sc">{</span>meta[<span class="st">'height'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"the number of bands in the raster layer is </span><span class="sc">{</span>meta[<span class="st">'count'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>px.imshow(ndwi, color_continuous_scale<span class="op">=</span><span class="st">"YlGn"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./lab-2.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Week 2</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./lab-2-practice-exercises.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-title">Week 2 (practice)</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>