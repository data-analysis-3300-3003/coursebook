<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>coursebook - 3&nbsp; Introduction</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./lab-2-self-guided.html" rel="next">
<link href="./lab-1-practice-exercises.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Introduction</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">coursebook</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Welcome</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./unit-overview.html" class="sidebar-item-text sidebar-link">Unit overview</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./software.html" class="sidebar-item-text sidebar-link">Software</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./readings.html" class="sidebar-item-text sidebar-link">Reading</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab-1.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 1</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab-1-practice-exercises.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 1 (practice)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab-2.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Week 2</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab-2-self-guided.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 2 (self-guided)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab-2-practice-exercises.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 2 (practice)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab-3.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 3</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab-3-self-guided.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 3 (self-guided)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab-3-practice-exercises.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 3 (practice)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab-4.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 4</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab-4-self-guided.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 4 (self-guided)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab-5.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 5</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab-5-self-guided.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 5 (self-guided)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab-6-self-guided.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 6 (self-guided)</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#data-io" id="toc-data-io" class="nav-link active" data-scroll-target="#data-io">Data I/O</a>
  <ul class="collapse">
  <li><a href="#task" id="toc-task" class="nav-link" data-scroll-target="#task">Task</a></li>
  </ul></li>
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a>
  <ul class="collapse">
  <li><a href="#run-the-labs" id="toc-run-the-labs" class="nav-link" data-scroll-target="#run-the-labs">Run the labs</a></li>
  <li><a href="#download-data" id="toc-download-data" class="nav-link" data-scroll-target="#download-data">Download data</a></li>
  <li><a href="#working-in-colab" id="toc-working-in-colab" class="nav-link" data-scroll-target="#working-in-colab">Working in Colab</a></li>
  <li><a href="#import-modules" id="toc-import-modules" class="nav-link" data-scroll-target="#import-modules">Import modules</a></li>
  </ul></li>
  <li><a href="#a-python-program-to-read-a-file" id="toc-a-python-program-to-read-a-file" class="nav-link" data-scroll-target="#a-python-program-to-read-a-file">A Python program to read a file</a></li>
  <li><a href="#files-and-io" id="toc-files-and-io" class="nav-link" data-scroll-target="#files-and-io">Files and I/O</a>
  <ul class="collapse">
  <li><a href="#files" id="toc-files" class="nav-link" data-scroll-target="#files">Files</a></li>
  </ul></li>
  <li><a href="#file-formats" id="toc-file-formats" class="nav-link" data-scroll-target="#file-formats">File formats</a></li>
  <li><a href="#directories-and-file-systems" id="toc-directories-and-file-systems" class="nav-link" data-scroll-target="#directories-and-file-systems">Directories and file systems</a></li>
  <li><a href="#files-in-python" id="toc-files-in-python" class="nav-link" data-scroll-target="#files-in-python">Files in Python</a>
  <ul class="collapse">
  <li><a href="#text-mode" id="toc-text-mode" class="nav-link" data-scroll-target="#text-mode">Text mode</a></li>
  <li><a href="#binary-mode" id="toc-binary-mode" class="nav-link" data-scroll-target="#binary-mode">Binary mode</a></li>
  <li><a href="#opening-files" id="toc-opening-files" class="nav-link" data-scroll-target="#opening-files">Opening files</a></li>
  <li><a href="#reading-files" id="toc-reading-files" class="nav-link" data-scroll-target="#reading-files">Reading files</a></li>
  <li><a href="#writing-files" id="toc-writing-files" class="nav-link" data-scroll-target="#writing-files">Writing files</a></li>
  <li><a href="#closing-files" id="toc-closing-files" class="nav-link" data-scroll-target="#closing-files">Closing files</a></li>
  </ul></li>
  <li><a href="#context-managers" id="toc-context-managers" class="nav-link" data-scroll-target="#context-managers">Context managers</a></li>
  <li><a href="#pandas-io" id="toc-pandas-io" class="nav-link" data-scroll-target="#pandas-io">Pandas I/O</a></li>
  <li><a href="#parquet-files" id="toc-parquet-files" class="nav-link" data-scroll-target="#parquet-files">Parquet files</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-title">Introduction</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="data-io" class="level2">
<h2 class="anchored" data-anchor-id="data-io">Data I/O</h2>
<p>Data analysis tasks involve reading data stored in files on disks, servers in the cloud, or recorded by sensors. Also, we need to save the results of our analysis or datasets we have generated to files.</p>
<p>There are a range of data types (e.g.&nbsp;string / text, numeric, datetime) and ways of characterising data such as tabular data, images and arrays, and spatial and non-spatial data. This necessitates storing data with different file formats. It’s important to be able to read and write data from and to different file formats into and out of Python data structures that we can analyse in our programs.</p>
<p>There are costs involved in storing and transferring data. These can be time costs associated with the time taken to read data from disk into the computer’s memory or transferring data from one computer to another over a network. Or, they can be financial costs associated with storing the data (the cost of hard drives increases with storage capacity and cloud storage providers charge by the byte).</p>
<p>The term big data refers to the increasing volume, variety, and velocity of data. Larger and more diverse datasets are being generated more quickly. To be able to handle big data it is important to select appropriate file formats for efficient storage and reading / writing (or input / output - I/O).</p>
<section id="task" class="level3">
<h3 class="anchored" data-anchor-id="task">Task</h3>
<p>In this lab we will write Python programs that can read crop yield data collected from harvesters and satellite images of the same field into data structures that we can analyse and visualise.</p>
<p>A solid understanding of how to read and write different types of data from and to files is a key skill for data analysis. This week’s lab will build these skills and provide an introduction to:</p>
<ul>
<li>files, directories, and data storage</li>
<li>reading and writing files in Python</li>
<li>tabular, image, and geospatial file formats</li>
<li>specialist file formats for the web, big data, and cloud computing</li>
<li>selecting different data formats for specific analysis or storage tasks</li>
</ul>
</section>
</section>
<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<section id="run-the-labs" class="level3">
<h3 class="anchored" data-anchor-id="run-the-labs">Run the labs</h3>
<p>You can run the labs locally on your machine or you can use cloud environments provided by Google Colab. <strong>If you’re working with Google Colab be aware that your sessions are temporary and you’ll need to take care to save, backup, and download your work.</strong></p>
<p><a href="https://colab.research.google.com/github/data-analysis-3300-3003/colab/blob/main/lab-2.ipynb" target="_blank"> <img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"> </a></p>
</section>
<section id="download-data" class="level3">
<h3 class="anchored" data-anchor-id="download-data">Download data</h3>
<p>If you need to download the date for this lab, run the following code snippet.</p>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">"week-2"</span> <span class="kw">not</span> <span class="kw">in</span> os.listdir(os.getcwd()):</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    os.system(<span class="st">'wget "https://github.com/data-analysis-3300-3003/data/raw/main/data/week-2.zip"'</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    os.system(<span class="st">'unzip "week-2.zip"'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="working-in-colab" class="level3">
<h3 class="anchored" data-anchor-id="working-in-colab">Working in Colab</h3>
<p>If you’re working in Google Colab, you’ll need to install the required packages that don’t come with the colab environment.</p>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">'google.colab'</span> <span class="kw">in</span> <span class="bu">str</span>(get_ipython()):</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="op">!</span>pip install geopandas</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">!</span>pip install pyarrow</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">!</span>pip install mapclassify</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">!</span>pip install rasterio</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="import-modules" class="level3">
<h3 class="anchored" data-anchor-id="import-modules">Import modules</h3>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> rasterio</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> folium</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.io <span class="im">as</span> pio</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pprint</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># setup renderer</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">'google.colab'</span> <span class="kw">in</span> <span class="bu">str</span>(get_ipython()):</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    pio.renderers.default <span class="op">=</span> <span class="st">"colab"</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    pio.renderers.default <span class="op">=</span> <span class="st">"jupyterlab"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="a-python-program-to-read-a-file" class="level2">
<h2 class="anchored" data-anchor-id="a-python-program-to-read-a-file">A Python program to read a file</h2>
<p>Let’s start with a simple program to open a CSV file, read some data from it into memory, and then close the connection to the file.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># path to csv file</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>elev_csv_path <span class="op">=</span> os.path.join(os.getcwd(), <span class="st">"week-2"</span>, <span class="st">"week-2-bf66-elevation.csv"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"path to elevation csv file:"</span>, elev_csv_path)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># open the file and read the first 1000 characters</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="bu">open</span>(elev_csv_path, <span class="st">"r"</span>, encoding<span class="op">=</span><span class="st">"utf-8"</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> f.read(<span class="dv">1000</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>f.close()</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">""</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The first 1000 characters of the csv file area:"</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>path to elevation csv file: /home/jovyan/work/week-2/week-2-bf66-elevation.csv

The first 1000 characters of the csv file area:
Northing,Easting,Lat,Lon,Elevation
6503882.129,545428.0052,-31.59926178,117.4788733,268.92
6503806.024,545427.6719,-31.59994843,117.4788733,265.908
6503881.794,545504.4826,-31.59926178,117.4796795,268.171
6503805.688,545504.1488,-31.59994843,117.4796795,265.413
6503729.582,545503.8149,-31.60063507,117.4796795,263.08
6503653.477,545503.481,-31.60132172,117.4796795,260.739
6504185.881,545582.2978,-31.5965152,117.4804856,273.014
6504109.775,545581.9634,-31.59720185,117.4804856,273.273
6504033.67,545581.629,-31.59788849,117.4804856,273.896
6503957.564,545581.2946,-31.59857514,117.4804856,272.369
6503881.458,545580.9601,-31.59926178,117.4804856,268.96
6503805.352,545580.6257,-31.59994843,117.4804856,264.807
6503729.246,545580.2913,-31.60063507,117.4804856,262.857
6503653.141,545579.9568,-31.60132172,117.4804856,260.894
6504337.756,545659.4474,-31.59514191,117.4812918,274.777
6504261.651,545659.1125,-31.59582856,117.4812918,273.813
6504185.545,545658.7775,-31.5965152,117.4812918,272.371
6504</code></pre>
</div>
</div>
</section>
<section id="files-and-io" class="level2">
<h2 class="anchored" data-anchor-id="files-and-io">Files and I/O</h2>
<section id="files" class="level3">
<h3 class="anchored" data-anchor-id="files">Files</h3>
<p>A file is data that is stored on a disk. Data in files is stored as a sequence bytes in binary format (values of zero or one).</p>
<p><img src="https://github.com/data-analysis-3300-3003/figs/raw/main/week-2-file-storage.jpg" class="img-fluid"></p>
<section id="binary" class="level4">
<h4 class="anchored" data-anchor-id="binary">Binary</h4>
<p>A binary number is represented using only the digits 1 or 0. The binary number system is a base-2 number system (as it has only two symbols).</p>
<p>The decimal number <code>0</code> in binary is <code>0</code>:</p>
<p><span class="math inline">\(0 = (0 \cdot 2^{0})\)</span></p>
<p>The decimal number <code>1</code> in binary is <code>1</code>:</p>
<p><span class="math inline">\(1 = (1 \cdot 2^{0})\)</span></p>
<p>The decimal number <code>2</code> in binary is <code>10</code>:</p>
<p><span class="math inline">\(2 = (1 \cdot 2^{1}) + (0 \cdot 2^{0})\)</span></p>
<p>The decimal number <code>3</code> in binary is <code>11</code>:</p>
<p><span class="math inline">\(3 = (1 \cdot 2^{1}) + (1 \cdot 2^{0})\)</span></p>
<p>The decimal number <code>4</code> in binary is <code>100</code>:</p>
<p><span class="math inline">\(4 = (1 \cdot 2^{2}) + (0 \cdot 2^{1}) + (0 \cdot 2^{0})\)</span></p>
<p>You don’t need to know the details of the binary number system here, but the key things to take away are:</p>
<ul>
<li>numbers are stored in binary using the digits 1 or 0</li>
<li>larger numbers require more binary digits</li>
<li>larger numbers, therefore, require more storage space</li>
</ul>
<p>There are plenty of resources online to learn more about number systems. This is a short article on <a href="https://www.w3schools.com/ai/ai_history_numbers.asp" target="_blank">The History of Numbers</a>.</p>
<p><strong>Bits</strong></p>
<p>A single binary digit is a bit. Looking at the pattern above we can store the numbers 0 and 1 using a 1-bit binary number. We can store the numbers 2 and 3 using a 2-bit binary number. We can store the number 4 using a 3-bit binary number. For every extra bit we double the numbers that can be stored in binary.</p>
<ul>
<li>1 bits = 2 numbers (0 and 1)</li>
<li>2 bits = 4 numbers (0 to 3)</li>
<li>3 bits = 8 numbers (0 to 7)</li>
<li>4 bits = 16 numbers (0 to 15)</li>
<li>5 bits = 32 numbers (0 to 31)</li>
<li>6 bits = 64 numbers (0 to 63)</li>
<li>7 bits = 128 numbers (0 to 128)</li>
<li>8 bits = 256 numbers (0 to 255)</li>
</ul>
<p><strong>Bytes</strong></p>
<p>A byte is an 8-bit binary number. With a single byte we can represent 256 different numbers. Computer storage is measured in bytes:</p>
<ul>
<li>1 Kilobyte (KB) is about 1,000 bytes.</li>
<li>1 Megabyte (MB) is about 1,000,000 bytes.</li>
<li>1 Gigabyte (GB) is about 1,000,000,000 bytes.</li>
</ul>
<p>A greyscale image file can store each pixel’s colour as an 8-bit number or as a single byte. Black is represented as the number 0 (00000000), white is the number 255 (11111111), and shades of grey are intermediate numbers (00000001 to 11111110).</p>
<p>If this greyscale image has 100x100 pixels (10,000 pixels), how many bytes of storage does this image require?</p>
<p><span class="math inline">\(10000 bytes = 10000 pixels \cdot 1 byte\)</span> as each pixel requires 1 byte of storage.</p>
<p>Generally, a common text character such as upper and lower case letters (A-Z, a-z) and symbols (!, @, # etc.) requires a byte of storage. The CSV file we read above stores text characters. We can use the <code>os.stats()</code> function to inspect the stats of this file in storage. Let’s pass the path to the <code>week-2-bf66-elevation.csv</code> file into the <code>os.stats()</code> function and see how many bytes are required to store this file.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>elev_csv_path <span class="op">=</span> os.path.join(os.getcwd(), <span class="st">"week-2"</span>, <span class="st">"week-2-bf66-elevation.csv"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>file_stats <span class="op">=</span> os.stat(elev_csv_path)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"File Size in Bytes is:"</span>,  file_stats.st_size)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>File Size in Bytes is: 23845</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="file-formats" class="level2">
<h2 class="anchored" data-anchor-id="file-formats">File formats</h2>
<p>A file format describes how data is encoded as binary sequences in files (sequences of 1 and 0 digits). The filename’s extension indicates the file format used (e.g.&nbsp;.jpg is a JPEG file, .tif is a TIFF or GeoTIFF file, .csv is a CSV file). Some file formats also include a header or magic number inside the file that indicates what the file format is. The header can also include some metadata information about the file.</p>
<p><img src="https://github.com/data-analysis-3300-3003/figs/raw/main/week-2-file-formats.jpg" class="img-fluid"></p>
<p>A Portable Network Graphics (<a href="" target="_blank">PNG</a>) file is a common file format for storing image data. It is identified by a .png ending and consists of sections of bytes on disk arranged as:</p>
<ol type="1">
<li>PNG signature including a magic number for the start of the file and a PNG file identifier.</li>
<li>Image header with image metadata such as the size of the image.</li>
<li>Image data.</li>
<li>Image end to indicate the end of the PNG file on disk.</li>
</ol>
<p><img src="https://github.com/data-analysis-3300-3003/figs/raw/main/week-2-png-format.jpg" class="img-fluid"></p>
<p>Different file formats encode data in different ways, and, thus, have different strengths and weaknesses. Some file formats prioritise efficient storage (compression) of data on disk (small file sizes and quick transfer), other prioritise quick read and writing of data, and others prioritise cross-platform compatibility or interpretation.</p>
<p>The various file formats for storing vector geospatial data provide a good illustration of how different formats store the same data but in ways that are better suited for different applications and uses. This is discussed <a href="https://macwright.com/2022/05/30/new-formats.html" target="_blank">here</a> and <a href="http://switchfromshapefile.org/" target="_blank">here</a>.</p>
<p>Many of you will have used shapefiles as a format for storing vector geospatial data. A strength of shapefiles is the range of software applications that can read and write data from and to them. However, they have drawbacks which mean they’re not suited to some use cases:</p>
<ul>
<li>Multifile format which makes data handling harder (you need a .shp, .shx, .prj, and .dbf file).</li>
<li>File size is limited to 2 GB which is prohibits their use for storing large datasets.</li>
<li>Attribute names are limited to 10 characters which can preclude using descriptive attribute and column names.</li>
<li>Each shapefile can only store one type of geometry (point or line or polygon) which prohibits representing complex geographic features in a single file.</li>
<li>No null value which can introduce complications for handling missing data.</li>
<li>Data types are limited to 256 characters which precludes storing large numbers / text strings.</li>
</ul>
<p>It is important to be aware of the characteristics of particular file formats and what their limits or benefits mean for your analysis. A simple example of why this is important: <em>we’ve processed several harvester yield datasets from different fields into a single dataset and want to save this dataset to file. If this dataset is larger than 2GB and we try and save to a shapefile there will be data loss.</em></p>
</section>
<section id="directories-and-file-systems" class="level2">
<h2 class="anchored" data-anchor-id="directories-and-file-systems">Directories and file systems</h2>
<p>Files are organised within a hierarchy of directories and sub-directories (or folders) in a computer system. We’re working in a Linux environment so the directory hierachy starts at the root denoted by <code>/</code>. Sub-directories are separated by <code>/</code>.</p>
<p>A program has a current working directory which is its current location within the directory hierarchy.</p>
<p>We can get the current working directory by calling the <code>os.getcwd()</code> function.</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>os.getcwd()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>'/home/jovyan/work'</code></pre>
</div>
</div>
<p>We can get a list of files and sub-directories within the current working directory by calling the <code>os.listdir()</code> function.</p>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>os.listdir()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>A path describes the location of a file within the computer system’s directory structure. We can create paths to files using the <code>os.path.join()</code> function. We pass in string data representing sub-directories and filenames and the <code>os.path.join()</code> function creates a file path.</p>
<p>Let’s get the file path for this notebook file: <code>lab-2.ipynb</code>.</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>os.path.join(os.getcwd(), <span class="st">"lab-2.ipynb"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>'/home/jovyan/work/lab-2.ipynb'</code></pre>
</div>
</div>
</section>
<section id="files-in-python" class="level2">
<h2 class="anchored" data-anchor-id="files-in-python">Files in Python</h2>
<p>In Python, it is possible to read and write files in text and binary modes.</p>
<section id="text-mode" class="level3">
<h3 class="anchored" data-anchor-id="text-mode">Text mode</h3>
<p>Text mode involves reading and writing string data from and to the file.</p>
<p>A text file contains encoded characters. ASCII and Unicode are character sets that define how characters (e.g.&nbsp;1, 2, 3, 66, A, b, !) are encoded in binary (sequences of 1 and 0 digits) in a file.</p>
<p>A character set translates characters into numbers and an encoding translates numbers into binary.</p>
<section id="ascii" class="level4">
<h4 class="anchored" data-anchor-id="ascii">ASCII</h4>
<p>ASCII stands for the American Standard Code for Information Interchange and has encodings for 128 English characters, numbers, and some special characters. ASCII characters are encoded using 7-bits. You can see the full ASCII character set <a href="https://www.w3schools.com/charsets/ref_html_ascii.asp" target="_blank">here</a>.</p>
<p>In ASCII, uppercase G is represented by the number 71, uppercase I is represented by the number 73, and uppcase S is represented by the number 83.</p>
<p>Thus, GIS in ASCII is written as <code>71 73 83</code> in its numeric representation and <code>01000111 01001001 01010011</code> in its binary representation (i.e.&nbsp;how it would be stored in a file).</p>
</section>
<section id="unicode" class="level4">
<h4 class="anchored" data-anchor-id="unicode">Unicode</h4>
<p>Unicode is a more modern and comprehensive character set of text symbols covering modern and ancient languages. Common encodings of the Unicode character set are UTF-8 and UTF-16. The Unicode character set includes over 1,000,000 characters and aims to be a universal system for representing and storing text in computer systems.</p>
<p>Unicode characters can be encoded in UTF-8 using one to four bytes. More common symbols (e.g.&nbsp;the ASCII character set) are encoded using one byte for efficient storage.</p>
<p>The Python <a href="https://docs.python.org/3/tutorial/inputoutput.html#reading-and-writing-files" target="_blank">docs</a> suggest UTF-8 is the modern de-facto standard so it is often the default encoding or a good one to choose if you are not sure how your data is encoded.</p>
</section>
</section>
<section id="binary-mode" class="level3">
<h3 class="anchored" data-anchor-id="binary-mode">Binary mode</h3>
<p>Reading files in binary mode does not assume that specific bytes represent human readable characters. When reading files in binary mode, sequences of bytes are read from the file into Python bytes objects in memory. Images such as JPEG files would be read in binary mode.</p>
<p>To be clear, both text and binary data is stored in binary format on disks. However, when reading in text data the binary data on disk is converted to text characters based on the encoding scheme used and read into string objects. When reading data in binary mode the binary data is read straight into memory as bytes objects. Reading and writing data in text mode will be slower because of the encoding overhead.</p>
</section>
<section id="opening-files" class="level3">
<h3 class="anchored" data-anchor-id="opening-files">Opening files</h3>
<p>The <code>open()</code> function opens a connection to a file on disk, or creates a new file if it does not exist, and returns a <code>file</code> connection object.</p>
<p>Typically, <code>open()</code> is called by specifying a filename, mode, and encoding as arguments: <code>open(filename, mode, encoding)</code>.</p>
<ul>
<li><strong>filename</strong>: the path and filename of the file to be opened.</li>
<li><strong>mode</strong>: the mode to open the connection to file in. To open files in text mode use <code>r</code> for read only, <code>w</code> for write only, <code>a</code> for appending data to the file, <code>r+</code> for reading and writing. To open files in binary mode use <code>rb</code> for read only, <code>wb</code> for write only, and <code>rb+</code> for reading and writing.</li>
<li><strong>the default is to open connections in text mode - be careful if you are opening a connection to a file that is not text data.</strong></li>
<li><strong>encoding</strong>: the encoding of the data in the file.</li>
</ul>
<p>Let’s open up a connection to a CSV file and explore the file object that’s returned.</p>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># open a connection to a csv file</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># path to csv file</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>elev_csv_path <span class="op">=</span> os.path.join(os.getcwd(), <span class="st">"week-2"</span>, <span class="st">"week-2-bf66-elevation.csv"</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># open the file </span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="bu">open</span>(elev_csv_path, <span class="st">"r"</span>, encoding<span class="op">=</span><span class="st">"utf-8"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>We’ve opened a connection to a CSV file in read mode <code>"r"</code> and with a <code>utf-8</code> encoding. This has returned to us <code>f</code>, a variable pointing to a <code>file</code> object.</p>
<p>What kind of object is <code>f</code> pointing to?</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>_io.TextIOWrapper</code></pre>
</div>
</div>
<p>Variable <code>f</code> is pointing at a <code>file</code> object, or, more specifically, an <code>_io.TextIOWrapper</code> type object. The <code>IO</code> stands for input / output which is another way of saying reading and writing data. The <code>Text</code> refers to the fact that <code>f</code> will be able to read data to string Python objects or write data from string Python objects to binary in files (i.e.&nbsp;it’s reading in text mode). The conversion from string to binary and binary to string is determined by the encoding (e.g.&nbsp;UTF-8 or ASCII).</p>
<p>The <code>file</code> object <code>f</code> is a connection to a file and it provides the methods to read (write) data from (to) this file via the connection.</p>
</section>
<section id="reading-files" class="level3">
<h3 class="anchored" data-anchor-id="reading-files">Reading files</h3>
<p>A read operation will copy bytes from the file on disk to the computer’s memory. The <code>file</code> object,<code>f</code>, has the <code>read()</code> and <code>readline()</code> methods.</p>
<p>The <code>read(size=n)</code> method in text mode will read <code>n</code> characters from the file. If <code>n</code> is omitted or is a negative number the <code>read()</code> function will read all of the characters in the file.</p>
<p>The <code>readline()</code> will read until a newline in the text file. Text files have newline characters that denote the end of a line. On Windows the newline character is <code>\r\n</code> and on Linux / MacOS it is <code>\n</code>.</p>
<p>Let’s test out the <code>read()</code> and <code>readline()</code> methods.</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read first 1000 characters from the csv file connected to by f</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>chars_1000 <span class="op">=</span> f.read(<span class="dv">1000</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(chars_1000)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Northing,Easting,Lat,Lon,Elevation
6503882.129,545428.0052,-31.59926178,117.4788733,268.92
6503806.024,545427.6719,-31.59994843,117.4788733,265.908
6503881.794,545504.4826,-31.59926178,117.4796795,268.171
6503805.688,545504.1488,-31.59994843,117.4796795,265.413
6503729.582,545503.8149,-31.60063507,117.4796795,263.08
6503653.477,545503.481,-31.60132172,117.4796795,260.739
6504185.881,545582.2978,-31.5965152,117.4804856,273.014
6504109.775,545581.9634,-31.59720185,117.4804856,273.273
6504033.67,545581.629,-31.59788849,117.4804856,273.896
6503957.564,545581.2946,-31.59857514,117.4804856,272.369
6503881.458,545580.9601,-31.59926178,117.4804856,268.96
6503805.352,545580.6257,-31.59994843,117.4804856,264.807
6503729.246,545580.2913,-31.60063507,117.4804856,262.857
6503653.141,545579.9568,-31.60132172,117.4804856,260.894
6504337.756,545659.4474,-31.59514191,117.4812918,274.777
6504261.651,545659.1125,-31.59582856,117.4812918,273.813
6504185.545,545658.7775,-31.5965152,117.4812918,272.371
6504</code></pre>
</div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read 10 lines of the csv file </span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">10</span>):</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(f.readline())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>109.439,545658.4425,-31.59720185,117.4812918,273.274

6504033.333,545658.1076,-31.59788849,117.4812918,272.729

6503957.227,545657.7726,-31.59857514,117.4812918,270.546

6503881.122,545657.4376,-31.59926178,117.4812918,267.788

6503805.016,545657.1026,-31.59994843,117.4812918,264.559

6503728.91,545656.7676,-31.60063507,117.4812918,262.08

6504641.842,545737.2702,-31.59239533,117.482098,273.551

6504565.737,545736.9348,-31.59308198,117.482098,273.001

6504489.631,545736.5993,-31.59376862,117.482098,274.043

6504413.525,545736.2638,-31.59445527,117.482098,274.396
</code></pre>
</div>
</div>
<p>You might notice that the call to <code>readline()</code> does not start with the row of column headers. This is because the <code>file</code> object <code>f</code> keeps a record of a position in the file up to where it has read bytes from. The call to <code>readline()</code> will start reading lines of characters from the file where the previous call to <code>read(1000)</code> finished.</p>
<p>We can use the <code>tell()</code> method to see a <code>file</code> object’s current position in a file.</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"current position in the file is </span><span class="sc">{</span>f<span class="sc">.</span>tell()<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>current position in the file is 1588</code></pre>
</div>
</div>
<p>The reason that <code>read()</code> or <code>readline()</code> provide the option to read data in <code>n</code> characters at a time or line by line is to help you avoid reading in more data than can fit in your computer’s memory. If you had a large file and called <code>read()</code> on it, without specifying the number of characters to read, it could fill up your memory.</p>
<p>As we’re reading from the file in text mode, the binary data from the file should be converted to Python string objects. We can check this.</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(chars_1000)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>str</code></pre>
</div>
</div>
</section>
<section id="writing-files" class="level3">
<h3 class="anchored" data-anchor-id="writing-files">Writing files</h3>
<p>The <code>write()</code> method of the <code>file</code> object writes Python objects (e.g.&nbsp;strings) to files. The data will then be stored on disk in a specified format until it is read again by another program.</p>
<p>When writing data in text mode Python string objects (characters) are encoded (e.g.&nbsp;using ASCII or UTF-8) and stored as bytes on the disk.</p>
<p>Let’s demonstrate a write operation by writing the 1000 characters stored in <code>chars_1000</code> to a new file. First, we need to open a connection to the new file in write mode and specify an encoding.</p>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>f2 <span class="op">=</span> <span class="bu">open</span>(<span class="st">"write_demo.csv"</span>, <span class="st">"w"</span>, encoding<span class="op">=</span><span class="st">"utf-8"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now, we can call the <code>write()</code> method of the <code>file</code> object <code>f2</code> and pass <code>write()</code> the variable <code>chars_1000</code> which points to 1000 characters stored as a string object. If the write is successful, it should return a number telling us how many characters were written (it should be 1000) and you should be able to see the file <em>write_demo.csv</em> in your current working directory.</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>f2.write(chars_1000)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>1000</code></pre>
</div>
</div>
</section>
<section id="closing-files" class="level3">
<h3 class="anchored" data-anchor-id="closing-files">Closing files</h3>
<p>After you have finished reading or writing data from and to the file, it is important to <code>close()</code> the connection to the file. The <code>file</code> object’s <code>close()</code> method does this.</p>
<p>Once the <code>close()</code> method has been called on a <code>file</code> object it is no longer possible to read or write data from and to the file. This is important to prevent accidental data loss or corruption.</p>
<p>We have two open file connections, let’s close them.</p>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>f.close()</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>f2.close()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="context-managers" class="level2">
<h2 class="anchored" data-anchor-id="context-managers">Context managers</h2>
<p>Context managers - the “correct” way to read and write data from and to files in Python.</p>
<p>Above we have gone through the process of opening connections to files, reading and writing data, and closing connections to files. However, there are lots of moving parts to this approach as you need to keep track of which connections are open to which files and to ensure you close connections when they are no longer needed. As applications grow and work with more data this can require handling many file connections which adds complexity and increases potential for mistakes / errors. Such mistakes / errors can result in data loss, corrupting files, or reduced security if file connections to private data are leaked.</p>
<p>There are two “better” ways to read and write data in Python:</p>
<ol type="1">
<li>using context managers.</li>
<li>using methods and functions provided by packages (e.g.&nbsp;pandas <code>read_csv()</code> function).</li>
</ol>
<p>Let’s open a file and read data from it using a context manager. <strong>A context manager ensures that connections to files are properly closed without explicitly having to code for it.</strong></p>
<p>To create a context, use the <code>with</code> statement.</p>
<p>We’ve already demonstrated how to open, read, and write data in text mode from a CSV file. Let’s use a context manager to demonstrate how to work with files in binary mode. Above we introduced the PNG file format for storing image data. We have a PNG file showing a Google Earth aerial image of the field we’re working in. The first few bytes of the PNG file should be the PNG signature including a magic number for the start of the file and an ASCII representation of the letters PNG.</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>png_file_path <span class="op">=</span> os.path.join(os.getcwd(), <span class="st">"week-2"</span>, <span class="st">"week-2-bf66-low-res.png"</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(png_file_path, <span class="st">"rb"</span>) <span class="im">as</span> f:</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(f.read(<span class="dv">1</span>)) <span class="co"># read and print the first byte</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(f.read(<span class="dv">3</span>)) <span class="co"># read and print the second, third, and fourth bytes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>b'\x89'
b'PNG'</code></pre>
</div>
</div>
<p>You will note that we opened a connection to the PNG file in <code>rb</code> mode. This indicates we are reading data in binary mode. Here, instead of reading in the data a character at a time (as we did when reading data in text mode) we are reading in <code>n</code> bytes of data.</p>
<p>You will also note when printing the binary data that is read from the PNG file there is a <code>b</code> in front of the text. This indicates the data being printed is of bytes type.</p>
<p>Finally, you will notice that we did not need to <code>close()</code> the file connection <code>f</code> as this is handled for us by working within the context of the <code>with</code> statement.</p>
<p>This is what the data in the PNG file we have just been reading looks like.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://github.com/data-analysis-3300-3003/figs/raw/main/week-2-bf66-low-res.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Imagery (c) 2022 CNES | Airbus, Imagery (c) 2022 | Airbus, Landsat | Copernicus, Maxar Technologies, Map Data (c) 2022</figcaption><p></p>
</figure>
</div>
<!-- *Imagery (c) 2022 CNES | Airbus, Imagery (c) 2022 | Airbus, Landsat | Copernicus, Maxar Technologies, Map Data (c) 2022* -->
</section>
<section id="pandas-io" class="level2">
<h2 class="anchored" data-anchor-id="pandas-io">Pandas I/O</h2>
<p>Many Python packages provide functions and methods to read and write data that safely open and close connections to files.</p>
<p>The pandas <code>read_csv()</code> function reads CSV data from disk into a pandas <code>DataFrame</code> object in a single line of code without us needing to explicitly close a connection to the file.</p>
<p>Let’s read some canola yield data collected by a harvester and stored as a CSV file into our program using the pandas <code>read_csv()</code> function.</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>canola_yield_df <span class="op">=</span> pd.read_csv(os.path.join(os.getcwd(), <span class="st">"week-2"</span>, <span class="st">"week-2-bf66-canola-yield.csv"</span>))</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The shape of the canola yield DataFrame is </span><span class="sc">{</span>canola_yield_df<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The shape of the canola yield DataFrame is (80755, 8)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>canola_yield_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Unnamed: 0</th>
      <th>Longitude</th>
      <th>Latitude</th>
      <th>Crop</th>
      <th>Time</th>
      <th>Variety</th>
      <th>DryYield</th>
      <th>Elevation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>117.497719</td>
      <td>-31.606760</td>
      <td>5</td>
      <td>11/11/2020 8:01</td>
      <td>43Y23 RR</td>
      <td>0.227</td>
      <td>264.32</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>117.497693</td>
      <td>-31.606743</td>
      <td>5</td>
      <td>11/11/2020 8:01</td>
      <td>43Y23 RR</td>
      <td>0.480</td>
      <td>264.34</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>117.497671</td>
      <td>-31.606733</td>
      <td>5</td>
      <td>11/11/2020 8:01</td>
      <td>43Y23 RR</td>
      <td>0.568</td>
      <td>264.42</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>117.497659</td>
      <td>-31.606738</td>
      <td>5</td>
      <td>11/11/2020 8:01</td>
      <td>43Y23 RR</td>
      <td>0.629</td>
      <td>264.48</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>117.497646</td>
      <td>-31.606742</td>
      <td>5</td>
      <td>11/11/2020 8:01</td>
      <td>43Y23 RR</td>
      <td>0.627</td>
      <td>264.60</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Pandas provides a range of convenient functions for reading and writing data - you can find a list of them <a href="https://pandas.pydata.org/docs/user_guide/io.html" target="_blank">here</a>.</p>
</section>
<section id="parquet-files" class="level2">
<h2 class="anchored" data-anchor-id="parquet-files">Parquet files</h2>
<p>So far we have been working with data in CSV format. The CSV format has many strengths for storing tabular data including:</p>
<ul>
<li>many software applications provide tools to read and write CSV data.</li>
<li>the data structure is relatively intuitive with human readable characters encoded in binary, data values (fields) comprise binary representations of characters and are separated by comma symbols (hence the name), and rows (records) are separated by newline symbols.</li>
<li>flexibility to choose different encodings of the text data.</li>
</ul>
<p>However, CSV files require that each data value is stored even if there is lots of repetition. For example, if there is a column that denotes the field name or id, for every row in the table the field name or id value would be repeated. As datasets get large, this can cause CSV files to increase in size which has subsequent storage costs.</p>
<p>An alternative file format for storing tabular is parquet. Parquet files are optimised for storage. This provides more efficient use of hard drives, cheaper cloud storage costs, and quicker transmission of data over the internet.</p>
<p>Parquet files have several optimisations for storing tabular data. Whereas CSV files are based around row storage, parquet files are based on column storage.</p>
<p><img src="https://github.com/data-analysis-3300-3003/figs/raw/main/week-2-parquet.jpg" class="img-fluid"></p>
<p>Parquet files can optimise storage of tabular data using <strong>run length encoding</strong> and <strong>dictionary encoding</strong>.</p>
<p>Run length encoding is useful for reducing storage when there are runs of the same value within a column. For example, in the <code>canola_yield_df</code> <code>DataFrame</code> the values in the Crop column repeat. Instead of storing every value, we can store the two values: the value that repeats and the number of repetitions in the column (e.g.&nbsp;<code>(5, 80755)</code> - instead of storing the number 5 80,755 times as would be the case in a CSV file we can just store two numbers 5 and 80,755). Run length encoding is not suited for CSV files as the data is stored by row, and, often, within a row you’ll have data of different types (e.g.&nbsp;string / text, numeric, and dates). This structure doesn’t lend itself to encoding runs of the same value - repitition in tabular data generally runs down columns not across rows.</p>
<p>Dictionary encoding is useful when we need to store large values (e.g.&nbsp;long names or large numbers). Instead of writing the large value repeatedly in the file a smaller value is written and there is a dictionary which acts as a look up table to correspond the small value to the actual large value. This means the large value only needs to be stored once.</p>
<p>For a single field, we have 80,755 records (rows) in the <code>DataFrame</code>. If we scaled up this analysis to work with data collected from harvesters across many fields in Western Australia we would quickly accumulate a large volume of data. At some stage we will hit issues with storing and transferring the data and it might be appropriate to switch from CSV to parquet files for data storage.</p>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>canola_yield_df.to_parquet(os.path.join(os.getcwd(), <span class="st">"week-2"</span>, <span class="st">"week-2-bf66-canola-yield.parquet"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Let’s compare the size of the CSV file storing the canola yield data and the parquet file we just saved. The parquet file should be much smaller.</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>file_stats_csv <span class="op">=</span> os.stat(os.path.join(os.getcwd(), <span class="st">"week-2"</span>, <span class="st">"week-2-bf66-canola-yield.csv"</span>))</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"CSV file size in bytes is:"</span>,  file_stats_csv.st_size)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>file_stats_parquet <span class="op">=</span> os.stat(os.path.join(os.getcwd(), <span class="st">"week-2"</span>, <span class="st">"week-2-bf66-canola-yield.parquet"</span>))</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Parquet file size in bytes is:"</span>,  file_stats_parquet.st_size)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CSV file size in bytes is: 5697740
Parquet file size in bytes is: 1549996</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./lab-1-practice-exercises.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Week 1 (practice)</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./lab-2-self-guided.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-title">Week 2 (self-guided)</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>